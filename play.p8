pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
function _init()
 __init__()
 mode = move_around
end

function _update()
 mode()
 ticks += 1
end

function _draw()
 draw_move_around()
end
-->8
--update and draw functions
function move_around()
 --🅾️
 if(btnp()&16!=0) mode=act_menu
 --⬇️⬆️➡️⬅️
 if btn()&15 != 0 then
  local th=dpad_angle[btn()&15]
  --❎
  if(th) move(pc, btn()&32, th)
 else pc.c = 1
 end
end

function draw_move_around()
 cls()
 map(0,0,0,0,16,16)
 spr(pc.fr[pc.c],pc.posx,
     pc.posy,1,1,pc.flipx)
end

function act_menu()
 if btnp(❎) then
  mode = move_around
 end
 if btnp(🅾️) then
  load("bits.p8")
 end
end
-->8
--frequently called functions

function move(self, spd, th)
 --move self by a 4-bit vector
 --spd 1-bit (slow or fast)
 --th 3-bit (45 deg resolution) 
 local compx = comp[th][1] 
 local speed =
  spd == 0 and .98 or 1.95
 if compx < 0 then
  self.flipx = false
 elseif compx > 0 then
  self.flipx = true
 end
 if(ticks%4==0) then
  self.c = (self.c + 1)%3 +1
 end 
 self.posx += speed 
  * compx
 self.posy += speed 
  * comp[th][2]
end
-->8
--secret __init__
function __init__()
 ticks = 0
 
 --init a table
 comp = {}
 for i=0, 7 do
  comp[i] = {sin(i/8), cos(i/8)}
 end

 --init a table
 dpad_angle={}
 --_dpad_bf holds dpad bit fields
 local _dpad_bf = 
  {8,9,1,5,4,6,2,10}
 for i=1,8 do
  --relate an angle value to
  --a specific bit field
  dpad_angle[_dpad_bf[i]] = i-1 
 end
end
-->8
--data structures
pc =
{
 posx=60,
 posy=60,
 flipx=false,
 fr={17,18,19},
 c=1
}
__gfx__
00000000011111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770001a1111a10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700011e11100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7dddddd6008888000088880000888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d6666665088888800888888008888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d666666508a8a88008a8a88008a8a880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d6666665088888800888888008888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d6666665088888800888888008888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d66666650888888008888a8008a88880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d666666500a00a0000a00a0000a00a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6555555d00a00a0000a0000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000200001a0701e0702207026070260700d07009000080002c0002c0002b0002800025000200001e0001a00000000000000000000000000000000000000000000000000000000000000000000000000000000000
