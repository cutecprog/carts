pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
function _init()
 mode = move_around
end

function _update()
 mode()
end

function _draw()
 move_around_draw()
end
-->8
--player
pc =
{
 posx=0,
 posy=0
}
-->8
--util
comp = {}
for i=0, 7 do
 comp[i] =
   {sin(i/8), cos(i/8)}
end

dpad_angle={}
--_dpad_bf holds dpad bit fields
local _dpad_bf = 
  {8,9,1,5,4,6,2,10}
for i=1,8 do
 --relate an angle value to
 --a specific bit field
 dpad_angle[_dpad_bf[i]] = i-1 
end


function move(self, fast, angle)
 local speed =
  fast == 0 and 3 or 4.5
 self.posx += speed * comp[angle][1]
 self.posy += speed * comp[angle][2]
end
-->8
--update and draw functions
function move_around()
 --🅾️
 if(btnp()&16!=0)mode=select_action
 
 --⬇️⬆️➡️⬅️
 if btn()&15 != 0 then
  local th=dpad_angle[btn()&15]
  --❎
  if(th) move(pc, btn()&32, th)
 end
end

function move_around_draw()
 cls()
 map(0,0,-pc.posx,-pc.posy,16,16)
 spr(1,60,60)
end

function select_action()
 if btnp(❎) then
  mode = move_around
 end
 if btnp(🅾️) then
  sfx(0)
 end
end
-->8
--test code
function test_update()
 bearing = dpad_bearing()
 if bearing then
 	print(comp[bearing+1][1])
 	print(comp[bearing+1][2])
 	print('------------')
 end
end
__gfx__
00000000011111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770001a1111a10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700011e11100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7dddddd6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d6666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d6666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d6666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d6666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d6666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d6666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6555555d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1000000000000000000000000000001000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000200001a0701e0702207026070260700d07009000080002c0002c0002b0002800025000200001e0001a00000000000000000000000000000000000000000000000000000000000000000000000000000000000
